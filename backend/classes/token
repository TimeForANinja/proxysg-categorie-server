import base64
import secrets
from dataclasses import field
from apiflask.validators import Length
from marshmallow_dataclass import dataclass

@dataclass
class Token:
    id: int = field(metadata={
        'required': True,
        "description": "UID of the Token"
    })
    name: str = field(metadata={
        'required': True,
        'validate': Length(min=1, max=255),
        "description": "Name of the Token"
    })
    token: str = field(metadata={
        'required': True,
        'validate': Length(min=50, max=255),
        "description": "API Token"
    })


def generate_token():
    return base64.urlsafe_b64encode(secrets.token_bytes(64)).decode('utf-8')